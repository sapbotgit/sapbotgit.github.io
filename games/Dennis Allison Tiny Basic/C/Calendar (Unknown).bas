10 REM "CALENDAR from 101 BASIC GAMES"
20 REM "Ported by Stefan 2022"
30 REM ""
40 C$=10
50 L0=365
60 DEF FNL(Y)=((Y%4=0) AND NOT (Y%100=0)) OR (Y%400=0)
100 DIM M(13)
110 INPUT "YEAR: ", Y
120 FOR I=1 TO 6: PRINT C$;: NEXT I
130 GOSUB 1000
135 D0=D
140 S=0
150 REM     "READ DAYS OF EACH MONTH"
160 FOR N=0 TO 12: READ M(N+1): NEXT N
165 IF FNL(Y) THEN L0=366: M(3)=29
170 REM
175 TAB(28): PRINT Y
180 FOR N=1 TO 12
190 PRINT: PRINT: S=S+M(N)
200 PRINT "** ";#4;S;
210 FOR I=1 TO 18: PRINT "*";: NEXT I
220 ON N GOTO 230,240,250,260,270,280,290,300,310,320,330,340
230 PRINT " JANUARY ";: GOTO 350
240 PRINT " FEBRUARY";: GOTO 350
250 PRINT "  MARCH  ";: GOTO 350
260 PRINT "  APRIL  ";: GOTO 350
270 PRINT "   MAY   ";: GOTO 350
280 PRINT "   JUNE  ";: GOTO 350
290 PRINT "   JULY  ";: GOTO 350
300 PRINT "  AUGUST ";: GOTO 350
310 PRINT "SEPTEMBER";: GOTO 350
320 PRINT " OCTOBER ";: GOTO 350
330 PRINT " NOVEMBER";: GOTO 350
340 PRINT " DECEMBER";
350 FOR I=1 TO 18: PRINT "*";: NEXT I
360 PRINT #4;" ";L0-S;"**";
370 REM   "366-S;     ON LEAP YEARS"
380 PRINT C$: PRINT "     S       M       T       W";
390 PRINT "       T       F       S"
400 PRINT
410 FOR I=1 TO 59: PRINT "*";: NEXT I
420 REM
430 FOR W=1 TO 6
440 PRINT C$
445 IF W=1 THEN TAB(4+(S-D0)%7*8)
450 ELSE TAB(4)
460 REM
470 FOR G=1 TO 7
480 D=D+1
490 D2=D-S
500 IF D2>M(N+1) THEN 580
510 IF D2>0 THEN PRINT #8;D2;
520 REM "TAB(4+8*G);"
530 NEXT G
540 REM
550 IF D2=M(N+1) THEN 590
560 NEXT W
570 REM
580 D=D-G
590 NEXT N
600 REM
610 FOR I=1 TO 6: PRINT C$;: NEXT I
620 DATA 0,31,28,31,30,31,30,31,31,30,31,30,31
630 REM  0,31,29,  ..., ON LEAP YEARS
640 END
1000 REM "ROUTINE TO CALCULATE THE START DAYS OF A YEAR"
1010 REM "Calculate D=0 (SUN), D=-1 (MON) from knowning that"
1020 REM "1979 started on a Monay, and that every year ends and starts"
1030 REM "on the same day except leap year"
1040 IF Y<1979 THEN PRINT "YEARS PRIOR 1979 NOT IMPLEMENTED": END
1050 D=1
1060 K=1979
1070 IF K=Y THEN D=-D: PRINT D: RETURN
1080 IF NOT FNL(K) THEN D=D+1 ELSE D=D+2
1090 K=K+1
1100 D=D%7
1110 GOTO 1070


